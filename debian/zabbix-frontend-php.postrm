#!/bin/sh -e

if [ -e /usr/share/debconf/confmodule ]; then
	 . /usr/share/debconf/confmodule
fi

if [ -f /usr/share/dbconfig-common/dpkg/frontend.postrm ]; then
    dbc_dbtypes="mysql, pgsql, sqlite3"
    . /usr/share/dbconfig-common/dpkg/frontend.postrm
    dbc_go zabbix-frontend-php $@
fi

case "$1" in
    failed-upgrade|abort-install|abort-upgrade|disappear|upgrade)
    ;;
    remove)
	    db_get zabbix-frontend-php/configure-apache
	    if [ "$RES" = "true" ]; then
            rm -f /etc/apache2/conf.d/zabbix
        fi
	
	    db_get zabbix-frontend-php/restart-webserver
	    res="$RET"
	    db_stop || true
	    if [ "$res" = "true" ]; then
            invoke-rc.d apache2 restart
	    fi
    ;;
    purge)
        if [ -x /usr/bin/ucf ]; then
            ucf --purge /etc/zabbix/dbconfig.php
        fi
        rm -f /etc/zabbix/dbconfig.php
    ;;

    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 1
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
